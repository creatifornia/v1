!function(){"use strict";function e(e,t=null){try{return JSON.parse(e)}catch{return t}}const t=new Map;let n=0;function o(e,t,n,o){const i={componentId:t.componentId,jsonPath:t.jsonPath,type:e,value:o.value,label:o.label,id:o.id,isChecked:o.isChecked,currentValue:o.currentValue,alwaysRequired:t.alwaysRequired,dependencies:t.dependencies,requiredDepend:t.requiredDepend,displayDepend:t.displayDepend,continueButtonId:t.continueButtonId,match:t.MATCH};console.group(`ðŸ“¤ Emitiendo evento de opciÃ³n (${e})`),console.table(i),console.groupEnd(),document.dispatchEvent(new CustomEvent("option-change",{detail:i})),"checkbox"===e?document.dispatchEvent(new CustomEvent("valid-change-checkbox",{detail:i})):"radio"===e&&document.dispatchEvent(new CustomEvent("valid-change-radio",{detail:i}))}document.addEventListener("data-ready",(function(){document.querySelectorAll("[component-id]").forEach((i=>{try{!function(i){const r=i.getAttribute("component-id"),c=i.getAttribute("storage-key")||null,l=i.getAttribute("storage-path")||"",a=i.getAttribute("json-path")||"",u="true"===String(i.getAttribute("dependencies")||"").toLowerCase(),s=i.getAttribute("value-key")||"value",d=i.getAttribute("label-key")||"label",p=i.getAttribute("tag-key")||"tag",h=i.getAttribute("id-key")||"id",b=i.getAttribute("click-key")||null,g=i.getAttribute("f-class")||"",y=i.getAttribute("l-class")||"",f=i.getAttribute("continue-button-id")||null,A=i.getAttribute("checkbox-limit")?parseInt(i.getAttribute("checkbox-limit")):null,v=(i.getAttribute("input-type")||"checkbox").toLowerCase(),m=i.getAttribute("group-component-id")||r,k=`${m}__${++n}`,S="true"===String(i.getAttribute("always-required")).trim().toLowerCase(),E=i.getAttribute("required-depend")||null,q=i.getAttribute("display-depend")||null,C=i.getAttribute("match")||null;if(!r||!a)return void console.error(`BuildOptions: component "${r}": faltan atributos mÃ­nimos (component-id, json-path).`);const L=i.querySelector('[role="group"]');if(!L)return void console.error(`BuildOptions: component "${r}": falta elemento con role="group".`);const w=i.querySelector("[c-field]");if(!w)return void console.error(`BuildOptions: component "${r}": falta plantilla [c-field].`);let x=null;if(c){const t=e(localStorage.getItem(c),null);t?l?x=function(e,t){if(e&&t)return t.split(".").reduce(((e,t)=>e&&void 0!==e[t]?e[t]:void 0),e)}(t,`${l}.options`):Array.isArray(t)?x=t:Array.isArray(t.options)&&(x=t.options):console.warn(`BuildOptions: component "${r}": no hay datos vÃ¡lidos en localStorage["${c}"].`)}Array.isArray(x)&&0!==x.length||(x=[]);let O=i.querySelector(`input[type="hidden"][cf-json-path="${a}"]`);O||(O=document.createElement("input"),O.type="hidden",O.setAttribute("cf-json-path",a),O.name=a,i.appendChild(O));S&&(O.setAttribute("data-required",""),O.setAttribute("always-required",""));f&&O.setAttribute("continue-trigger",f);O.value="checkbox"===v?O.value||"[]":O.value||"{}";for(;L.firstChild;)L.removeChild(L.firstChild);x.length&&x.forEach((e=>{const t=w.cloneNode(!0);try{t.querySelectorAll("input").forEach((e=>{try{e.hasAttribute&&e.hasAttribute("checked")&&e.removeAttribute("checked"),void 0!==e.checked&&(e.checked=!1)}catch(e){}}))}catch(e){}const n=t.querySelector("[c-tag]"),o=t.querySelector("[c-label]"),i=t.querySelector('[native-button], input[type="checkbox"], input[type="radio"], input'),c=String(e[d]??""),l=String(e[p]??"").trim(),a=String(e[s]??""),u=h&&void 0!==e[h]?String(e[h]):null,g=b&&void 0!==e[b]?String(e[b]):null;if(o&&(o.textContent=c),n&&(l?(n.textContent=l,n.style.display=""):(n.textContent="",n.style.display="none")),i){i.type=v,i.setAttribute("data-opt-value",a),i.setAttribute("data-opt-label",c),u&&i.setAttribute("data-opt-id",u),l&&i.setAttribute("data-opt-tag",l),g&&i.setAttribute("data-opt-click",g),"radio"===v&&(i.name=k);try{i.hasAttribute&&i.hasAttribute("checked")&&i.removeAttribute("checked"),void 0!==i.checked&&(i.checked=!1)}catch(e){}}else console.warn(`BuildOptions: component "${r}": clone c-field no contiene native-button ni input detectable.`);g&&t.setAttribute("cl",g),L.appendChild(t)}));L._hasDelegate||(L.addEventListener("change",(n=>function(n,i){const r=n.target;if(!(r&&r instanceof HTMLInputElement))return;const c=t.get(i);if(!c)return;const{inputType:l,hiddenEl:a,checkboxLimit:u,fClass:s,lClass:d,groupEl:p,dependencies:h}=c,b=r.getAttribute("data-opt-value"),g=r.getAttribute("data-opt-label")||"",y=r.getAttribute("data-opt-id")||null,f=r.checked;if("checkbox"===l){let t=e(a.value,[]);t=Array.isArray(t)?t:[];const n=t.some((e=>String(e.value)===String(b)));if(f&&!n){if(u&&t.length>=u)return A=`Selecciona mÃ¡ximo ${u} opciones.`,"function"==typeof showToast?showToast(A,"error"):"function"==typeof alert?alert(A):console.error(A),void(r.checked=!1);const e={value:b,label:g};y&&(e.id=y),t.push(e)}else!f&&n&&(t=t.filter((e=>String(e.value)!==String(b))));const i=r.closest("[c-field]");i&&s&&i.classList.toggle(s,f);const l=i&&i.querySelector("[c-label]");l&&d&&l.classList.toggle(d,f),a.value=JSON.stringify(t),c.currentValue=t.slice(),o("checkbox",c,r,{value:b,label:g,id:y,isChecked:f,currentValue:t})}else if("radio"===l){const e={value:b,label:g};y&&(e.id=y),p.querySelectorAll("[c-field]").forEach((e=>{s&&e.classList.remove(s);const t=e.querySelector("[c-label]");t&&d&&t.classList.remove(d)}));const t=r.closest("[c-field]");t&&s&&t.classList.add(s);const n=t&&t.querySelector("[c-label]");n&&d&&n.classList.add(d),a.value=JSON.stringify(e),c.currentValue=Object.assign({},e),o("radio",c,r,{value:b,label:g,id:y,isChecked:!0,currentValue:c.currentValue})}var A}(n,r))),L._hasDelegate=!0);t.set(r,{componentId:r,componentEl:i,storageKey:c,storagePath:l,jsonPath:a,dependencies:u,valueKey:s,labelKey:d,tagKey:p,idKey:h,clickKey:b,fClass:g,lClass:y,continueButtonId:f,checkboxLimit:A,inputType:v,groupEl:L,fieldTemplate:w,hiddenEl:O,alwaysRequired:S,displayDepend:q,requiredDepend:E,MATCH:C,currentValue:"checkbox"===v?[]:{}}),function(n){const o=t.get(n);if(!o)return;const{hiddenEl:i,inputType:r,groupEl:c,fClass:l,lClass:a}=o,u=i.value;if(null==u)return;const s=e(u,null);c.querySelectorAll("[c-field]").forEach((e=>{l&&e.classList.remove(l);const t=e.querySelector("[c-label]");t&&a&&t.classList.remove(a);const n=e.querySelector("[native-button], input");if(n)try{n.hasAttribute&&n.hasAttribute("checked")&&n.removeAttribute("checked"),void 0!==n.checked&&(n.checked=!1)}catch(e){}})),"checkbox"===r&&Array.isArray(s)?(s.forEach((e=>{c.querySelectorAll("[native-button], input").forEach((t=>{if(String(t.getAttribute("data-opt-value"))===String(e.value)){try{t.checked=!0}catch(e){}const e=t.closest("[c-field]");e&&l&&e.classList.add(l);const n=e&&e.querySelector("[c-label]");n&&a&&n.classList.add(a)}}))})),o.currentValue=s.slice()):"radio"===r&&s&&"object"==typeof s&&Object.keys(s).length?(c.querySelectorAll("[native-button], input").forEach((e=>{if(String(e.getAttribute("data-opt-value"))===String(s.value)){try{e.checked=!0}catch(e){}const t=e.closest("[c-field]");t&&l&&t.classList.add(l);const n=t&&t.querySelector("[c-label]");n&&a&&n.classList.add(a)}})),o.currentValue=s):o.currentValue="checkbox"===r?[]:{}}(r)}(i)}catch(e){console.error("BuildOptions: Error building component",i.getAttribute("component-id"),e)}})),document.dispatchEvent(new Event("options-builder-ready"))})),window.__OptionsBuilder={COMPONENTS:t}}();