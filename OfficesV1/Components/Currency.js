document.addEventListener("data-ready",(function(){function e(e,t){try{const r=JSON.parse(localStorage.getItem(e));return t.split(".").reduce(((e,t)=>e?.[t]),r)}catch(r){return void console.warn(`⚠️ Error accediendo a ${e}.${t}`)}}if(!!!e("offices","country.currency.cents"))return void document.dispatchEvent(new Event("currency-cents"));document.querySelectorAll("[cf-currency-build]").forEach((t=>{const r=t.querySelector("input[type='text']");if(!r)return;const n=e("offices","country.currency.ISO_4217"),c=e("offices","country.currency.symbol"),u=parseFloat(t.getAttribute("cf-min-currency"))||0,a=parseFloat(t.getAttribute("cf-max-currency"))||Number.MAX_SAFE_INTEGER,i=t.getAttribute("cf-currency-path"),o="true"===t.getAttribute("cf-required"),s=e("offices","country.currency.required_message"),d=e("offices","country.currency.minimum_message"),l=e("offices","country.currency.max_message"),m=d?`${d} ${c}${(u/100).toFixed(2)}`:`El monto mínimo es ${c}${(u/100).toFixed(2)}`,y=l?`${l} ${c}${(a/100).toFixed(2)}`:`El monto máximo es ${c}${(a/100).toFixed(2)}`,f=t.querySelector("[this-is-currency]");f&&(f.textContent=n);const g=document.createElement("input");g.type="hidden",g.name=i,g.setAttribute("cf-json-path",i),g.setAttribute("data-min-amount",u),g.setAttribute("data-max-amount",a),g.setAttribute("data-currency-symbol",c),g.setAttribute("data-currency-code",n),g.setAttribute("data-min-message",m),g.setAttribute("data-max-message",y),o&&s&&(g.setAttribute("data-required",""),g.setAttribute("data-required-message",s)),t.insertBefore(g,r.nextSibling);let v=0,b="";const p=e=>`${c}${e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}`,$=e=>`${c}${e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")} ${n}`,E=e=>{const t=parseFloat(e.replace(/,/g,"."))||0;v=t,g.value=JSON.stringify({unit_amount:Math.round(100*t),display_value:p(t),display_value_full:$(t),currency:n,symbol:c,raw_value:t})};r.addEventListener("input",(e=>{const t=e.target.value;if(!(e=>{if((e.match(/[.,]/g)||[]).length>1)return!1;if(e.includes(".")||e.includes(",")){const t=e.split(/[.,]/);if(t[1]&&t[1].length>2)return!1}return/^[\d.,]*$/.test(e)})(t))return r.classList.add("invalid"),setTimeout((()=>r.classList.remove("invalid")),500),void(e.target.value=b);b=t,E(t)})),r.addEventListener("blur",(()=>{v<u/100?(r.value=p(u/100),E((u/100).toString()),showErrorModal(m)):v>a/100?(r.value=p(a/100),E((a/100).toString()),showErrorModal(y)):r.value=p(v)}))})),document.dispatchEvent(new Event("currency-builder-ready"))}));