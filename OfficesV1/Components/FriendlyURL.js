document.addEventListener("data-ready",(function(){function e(e,t){try{const r=JSON.parse(localStorage.getItem(e));return t.split(".").reduce(((e,t)=>e?.[t]),r)}catch(r){return void console.warn(`⚠️ Error accediendo a ${e}.${t}`)}}document.querySelectorAll("friendly-url").forEach((t=>{const r=t.getAttribute("json-path"),n=t.getAttribute("message-path"),a=t.getAttribute("preview-username"),i=t.getAttribute("preview-url-friendly"),l=e("dynamic",n),u=t.querySelector("[update-this-with-type-username]"),c=t.querySelector("[update-this-with-type-url]"),o=t.querySelector("[text-input-element]"),d=document.createElement("input");function s(e){return/^[\p{L}\p{N}\s_-]$/u.test(e)}function p(){o.classList.add("invalid"),setTimeout((()=>o.classList.remove("invalid")),500)}function g(t){const r=t.trim(),n=r.replace(/-/g,"_").replace(/\s+/g," "),l=t.trim().toLowerCase().replace(/\s+/g,"-").replace(/_/g,"-").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w-]/g,"");u&&(u.textContent=n||e("dynamic",a)),c&&(c.textContent=l||e("dynamic",i)),d.value=JSON.stringify({club_name:r,url_friendly:l})}if(d.type="hidden",d.setAttribute("cf-json-path",r),d.setAttribute("data-required-message",l),d.setAttribute("data-required",""),d.value=JSON.stringify({club_name:"",url_friendly:""}),t.insertBefore(d,t.firstChild),o){let e="";const t=20;o.addEventListener("input",(r=>{const n=r.target.value;if(n.length>t)return o.value=e,void p();const a=n.length>e.length?n.charAt(n.length-1):null;if(a&&!s(a))return o.value=e,void p();e=n,g(n)})),o.addEventListener("keypress",(e=>{s(String.fromCharCode(e.keyCode||e.which))||(e.preventDefault(),p())})),o.addEventListener("paste",(r=>{r.preventDefault();const n=(r.clipboardData||window.clipboardData).getData("text");let a=e;for(const e of n){if(a.length>=t)break;s(e)&&(a+=e)}o.value=a,e=a,g(a),a.length<e.length+n.length&&p()})),g(o.value||""),e=o.value||""}})),document.dispatchEvent(new Event("url-builder-ready"))}));