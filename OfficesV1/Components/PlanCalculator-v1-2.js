document.addEventListener("data-ready",(function(){function e(e,t){try{const n=JSON.parse(localStorage.getItem(e));return t.split(".").reduce(((e,t)=>e?.[t]),n)}catch(n){return void console.warn(`⚠️ Error accediendo a ${e}.${t}`)}}if(!!!e("offices","currency.cents"))return void document.dispatchEvent(new Event("plan-calculator-cents"));const t=document.querySelectorAll("[plan_calculator]"),n=e("offices","currency.ISO_4217"),r=e("offices","currency.symbol");n?(t.forEach((t=>{const a=t.getAttribute("plan_id"),o=parseInt(t.getAttribute("limit")||5),c=t.getAttribute("json-path"),l=t.getAttribute("click_this"),s=parseFloat(e("data",`scalable_plans.${a}.${n}.raw_value_1`)),i=parseFloat(e("data",`scalable_plans.${a}.${n}.raw_value_second_unit`));if(isNaN(s)||isNaN(i))return void console.error(`Datos incompletos o inválidos para plan ${a} y moneda ${n}`);const u=t.querySelector("[currency]"),d=t.querySelector("[first_unit][second_unit]"),p=t.querySelector("[symbol]"),y=t.querySelector("[storage_unit]"),f=y?.getAttribute("storage_unit"),m=t.querySelector("[storage_base]"),v=t.querySelector('[cf="disminuir"]')?.closest("a"),_=t.querySelector('[cf="aumentar"]')?.closest("a");u&&(u.textContent=n);const g=parseInt(m?.getAttribute("storage_base"));let b=1,E=s;const S=document.createElement("input");function $(){m&&(m.textContent=g*b),d&&(d.textContent=`${r}${E.toFixed(2)}`),p&&(p.textContent=r),y&&(y.textContent=f),v&&v.classList.toggle("inutil",1===b),S.value=b,console.log(`🔢 hiddenInput.value actualizado a ${b}`)}S.type="hidden",S.name=c,S.setAttribute("cf-json-path",c),S.setAttribute("data-required","true"),S.value=b,t.appendChild(S),v&&v.addEventListener("click",(e=>{e.preventDefault(),b>1&&(b--,E=1===b?s:E-i,$())})),_&&_.addEventListener("click",(e=>{e.preventDefault(),b<o?(b++,E+=i,$()):l&&document.getElementById(l)?.click()})),$()})),document.dispatchEvent(new Event("plan-calculator-ready"))):console.error("No se pudo obtener la moneda")}));