function showErrorModal(e){"function"==typeof showToast?showToast(e,"error"):"function"==typeof alert?alert(e):console.error(e)}document.addEventListener("options-builder-ready",(()=>{document.querySelectorAll("[cf-options-value]").forEach((e=>{e.addEventListener("change",(()=>{const t=e.getAttribute("cf-options-value"),o=e.getAttribute("cf-options-label"),c=e.getAttribute("cf-options-id"),i=e.getAttribute("cf-options-path"),a=e.type,l=e.closest("[data-options-field]"),n=e.closest("[data-options-group]"),r=e.getAttribute("cf-options-active");if(!i||!n)return;const s=n.querySelector(`input[type="hidden"][cf-json-path="${i}"]`);if(!s)return void console.error(`No input hidden con cf-json-path="${i}"`,n);let u;if("checkbox"===a)try{u=JSON.parse(s.value||"[]")}catch{u=[],console.warn("Error parseando JSON:",s.value)}else if("radio"===a)try{u=s.value?JSON.parse(s.value):null}catch{u=null}const d={value:t,label:o,...c&&{id:c}};if("checkbox"===a){const o=e.checked,c=u.some((e=>e.value===t));if(o&&!c){const t=s.hasAttribute("cf-checkbox-limit")?parseInt(s.getAttribute("cf-checkbox-limit")):null;if(null!==t&&u.length>=t)return showErrorModal(`Selecciona mÃ¡ximo ${t} opciones.`),void(e.checked=!1)}l?.classList.toggle(r,o),o&&!c?u.push(d):!o&&c&&(u=u.filter((e=>e.value!==t)))}else"radio"===a&&(n.querySelectorAll(`[type="radio"][cf-options-path="${i}"]`).forEach((e=>e.closest("[data-options-field]")?.classList.remove(r))),l?.classList.add(r),u=d);s.value="checkbox"===a||u?JSON.stringify(u):"",document.dispatchEvent(new CustomEvent(`valid-change-${a}`,{detail:{input:e,value:t,label:o,id:c,path:i,type:a,isChecked:e.checked}}))}))}))}));