document.addEventListener("creatifornia-ready",initOptions);const CURRENT_SYSTEM_VERSION="v1.0";function initOptions(){const o=localStorage.getItem("AuthToken"),t=localStorage.getItem("options"),e=new URLSearchParams(window.location.search).has("update");if(e&&t&&(console.log("üîÑ Refresh by URL"),localStorage.removeItem("options")),t&&!e)try{const o=JSON.parse(t);if(o.version===CURRENT_SYSTEM_VERSION)return document.dispatchEvent(new Event("options-ready")),void console.log("ü¶ß Options");localStorage.removeItem("options")}catch(o){console.warn("Corrupted options, refreshing..."),localStorage.removeItem("options")}if(o){xano.setAuthToken(o);const t=o=>o.reduce(((o,t)=>{const e=Object.keys(t)[0];return o[e]=t[e],o}),{}),e=o=>Object.fromEntries(Object.entries(o).map((([o,t])=>{if(!Array.isArray(t))return[o,t];const e=t.find((o=>o.options)),n=t.find((o=>o.message));return[o,{options:e?.options||[],message:n?.message||"Elige una opci√≥n"}]}))),n=(o=0)=>{const t=JSON.parse(localStorage.getItem("offices")||"{}"),e=t.country?.lang?.ISO_639,r=t.country?.ISO_3166_1_alfa_2;if(e&&r||o>=30){return{lang:e||"es",country:r||"MX"}}return new Promise((t=>{setTimeout((()=>{t(n(o+1))}),50)}))};(async()=>{try{const{lang:o,country:r}=await n(),s=`/options?lang=${o}&country=${r}`,a=await xano.get(s);if(a?.body){const o={},n=[];a.body.forEach((t=>{const e=Object.keys(t)[0];Array.isArray(t[e])?n.push(t):o[e]=t[e]}));const r=t(n),s=e(r),i={...o,...s};localStorage.setItem("options",JSON.stringify(i)),console.log(`ü¶ß Options ${CURRENT_SYSTEM_VERSION}`),document.dispatchEvent(new Event("options-ready"))}}catch(o){console.error("‚ùå Options error:",o)}})()}}