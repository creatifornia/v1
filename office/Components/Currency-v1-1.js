document.addEventListener("data-ready",(function(){const e=window.Offices?.get("country.currency.cents");if(!e)return void document.dispatchEvent(new Event("currency-cents"));document.querySelectorAll("[cf-currency-build]").forEach((e=>{const t=e.querySelector("input[type='text']");if(!t)return;const r=window.Offices?.get("country.currency.ISO_4217")||"MXN",n=window.Offices?.get("country.currency.symbol")||"$",c=parseFloat(e.getAttribute("cf-min-currency"))||0,i=parseFloat(e.getAttribute("cf-max-currency"))||Number.MAX_SAFE_INTEGER,u=e.getAttribute("cf-currency-path"),a="true"===e.getAttribute("cf-required"),s=window.Offices?.get("country.currency.required_message"),o=window.Offices?.get("country.currency.minimum_message")?`${window.Offices?.get("country.currency.minimum_message")} ${n}${(c/100).toFixed(2)}`:`El monto mínimo es ${n}${(c/100).toFixed(2)}`,d=window.Offices?.get("country.currency.max_message")?`${window.Offices?.get("country.currency.max_message")} ${n}${(i/100).toFixed(2)}`:`El monto máximo es ${n}${(i/100).toFixed(2)}`,l=e.querySelector("[this-is-currency]");l&&(l.textContent=r);const m=document.createElement("input");m.type="hidden",m.name=u,m.setAttribute("cf-json-path",u),m.setAttribute("data-min-amount",c),m.setAttribute("data-max-amount",i),m.setAttribute("data-currency-symbol",n),m.setAttribute("data-currency-code",r),m.setAttribute("data-min-message",o),m.setAttribute("data-max-message",d),a&&s&&(m.setAttribute("data-required",""),m.setAttribute("data-required-message",s)),e.insertBefore(m,t.nextSibling);let y=0,f="";const g=e=>`${n}${e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}`,b=e=>`${n}${e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")} ${r}`,v=e=>{const t=parseFloat(e.replace(/,/g,"."))||0;y=t,m.value=JSON.stringify({unit_amount:Math.round(100*t),display_value:g(t),display_value_full:b(t),currency:r,symbol:n,raw_value:t})};t.addEventListener("input",(e=>{const r=e.target.value;if(!(e=>{if((e.match(/[.,]/g)||[]).length>1)return!1;if(e.includes(".")||e.includes(",")){const t=e.split(/[.,]/);if(t[1]&&t[1].length>2)return!1}return/^[\d.,]*$/.test(e)})(r))return t.classList.add("invalid"),setTimeout((()=>t.classList.remove("invalid")),500),void(e.target.value=f);f=r,v(r)})),t.addEventListener("blur",(()=>{y<c/100?(t.value=g(c/100),v((c/100).toString()),showErrorModal(o)):y>i/100?(t.value=g(i/100),v((i/100).toString()),showErrorModal(d)):t.value=g(y)}))})),document.dispatchEvent(new Event("currency-builder-ready"))}));