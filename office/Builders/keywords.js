function buildKeywords(){document.querySelectorAll("[cf-keywords-build]").forEach((e=>{const t=e.getAttribute("cf-keywords-build"),r=e.getAttribute("form-path"),i=e.getAttribute("keywords-limit"),o=e.getAttribute("maxlength")||"256",n=e.getAttribute("cf-required"),d=DynamicText.get("keywords"),l=e.getAttribute("cf-child"),a=e.getAttribute("cf-target"),s=document.getElementById(t);if(!s)return void console.error(`❌ No se encontró template con id="${t}"`);e.style.display="block",e.style.opacity="1",e.style.visibility="visible";const u=s.cloneNode(!0);u.removeAttribute("id"),u.style.display="block",e.appendChild(u);const c=u.querySelector("[words-group]"),y=c.querySelector("[word-button]").cloneNode(!0),b=u.querySelector("[text-field-container]"),p=b.querySelector("[keywords-input]"),f=b.querySelector("[add-button]");c.innerHTML="",p.setAttribute("maxlength",o);const g=document.createElement("input");g.type="hidden",g.setAttribute("cf-json-path",r),g.setAttribute("name",r),g.setAttribute("data-required-message",d),g.setAttribute("cf-options-child",l),g.setAttribute("cf-options-target",a),g.value="[]","true"===n&&g.setAttribute("data-required",""),e.insertBefore(g,u);let m=[];const v=()=>{g.value=JSON.stringify(m),c.innerHTML="",m.forEach(((e,t)=>{const r=y.cloneNode(!0);r.querySelector("[generated-keyword]").textContent=e,r.addEventListener("click",(e=>{e.preventDefault(),m=m.filter(((e,r)=>r!==t)),v()})),c.appendChild(r)}))},h=()=>{const e=p.value.trim();e&&(i&&m.length>=parseInt(i)?showErrorModal(`Máximo ${i} palabras permitidas`):m.includes(e)?showErrorModal("Esta palabra ya fue agregada"):(m.push(e),p.value="",v()))};f.addEventListener("click",(e=>{e.preventDefault(),h()})),p.addEventListener("keypress",(e=>{"Enter"===e.key&&(e.preventDefault(),h())})),s.style.display="none",v()})),document.dispatchEvent(new Event("keywords-builder-ready"))}document.addEventListener("data-ready",buildKeywords);