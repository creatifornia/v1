document.addEventListener("data-ready",(function(){document.querySelectorAll("[url-friendly]").forEach((e=>{const t=e.getAttribute("url-friendly"),n=e.getAttribute("json-path"),r=document.getElementById(t),a=e.getAttribute("message-path"),i=DynamicText.getWithDefault(a,"Campo requerido");if(!r)return void console.error(`❌ No se encontró template con id="${t}"`);const l=r.cloneNode(!0);l.removeAttribute("id"),e.appendChild(l);const u=l.querySelector("[update-this-with-type-username]"),o=l.querySelector("[update-this-with-type-url]"),d=l.querySelector("[text-input-element]"),s=document.createElement("input");function c(e){return/^[\p{L}\p{N}\s_-]$/u.test(e)}function p(){d.classList.add("invalid"),setTimeout((()=>d.classList.remove("invalid")),500)}function g(e){const t=e.trim(),n=t.replace(/-/g,"_").replace(/\s+/g," "),r=e.trim().toLowerCase().replace(/\s+/g,"-").replace(/_/g,"-").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w-]/g,"");u&&(u.textContent=n||DynamicText.getWithDefault(a,"")),o&&(o.textContent=r||DynamicText.getWithDefault(a,"")),s.value=JSON.stringify({club_name:t,url_friendly:r})}if(s.type="hidden",s.setAttribute("cf-json-path",n),s.setAttribute("data-required-message",i),s.setAttribute("data-required",""),s.value=JSON.stringify({club_name:"",url_friendly:""}),e.insertBefore(s,l),d){let e="";const t=20;d.addEventListener("input",(n=>{const r=n.target.value;if(r.length>t)return d.value=e,void p();const a=r.length>e.length?r.charAt(r.length-1):null;if(a&&!c(a))return d.value=e,void p();e=r,g(r)})),d.addEventListener("keypress",(e=>{c(String.fromCharCode(e.keyCode||e.which))||(e.preventDefault(),p())})),d.addEventListener("paste",(n=>{n.preventDefault();const r=(n.clipboardData||window.clipboardData).getData("text");let a=e;for(const e of r){if(a.length>=t)break;c(e)&&(a+=e)}d.value=a,e=a,g(a),a.length<e.length+r.length&&p()})),g(d.value),e=d.value}r.style.display="none"})),document.dispatchEvent(new Event("url-builder-ready"))}));