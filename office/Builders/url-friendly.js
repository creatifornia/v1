document.addEventListener("data-ready",(function(){document.querySelectorAll("[url-friendly]").forEach((e=>{const t=e.getAttribute("url-friendly"),n=e.getAttribute("json-path"),r=document.getElementById(t),a=e.getAttribute("message-username"),i=e.getAttribute("message-url"),l=DynamicText.getWithDefault(a,"Username"),u=DynamicText.getWithDefault(i,"username");if(!r)return void console.error(`❌ No se encontró template con id="${t}"`);const s=r.cloneNode(!0);s.removeAttribute("id"),e.appendChild(s);const o=s.querySelector("[update-this-with-type-username]"),d=s.querySelector("[update-this-with-type-url]"),c=s.querySelector("[text-input-element]"),g=document.createElement("input");function m(e){return/^[\p{L}\p{N}\s_-]$/u.test(e)}function p(){c.classList.add("invalid"),setTimeout((()=>c.classList.remove("invalid")),500)}function f(e){const t=e.trim(),n=t.replace(/-/g,"_").replace(/\s+/g," "),r=e.trim().toLowerCase().replace(/\s+/g,"-").replace(/_/g,"-").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w-]/g,"");o&&(o.textContent=n||DynamicText.getWithDefault(l,"")),d&&(d.textContent=r||DynamicText.getWithDefault(u,"")),g.value=JSON.stringify({club_name:t,url_friendly:r})}if(g.type="hidden",g.setAttribute("cf-json-path",n),g.setAttribute("data-required-message",buildMessage),g.setAttribute("data-required",""),g.value=JSON.stringify({club_name:"",url_friendly:""}),e.insertBefore(g,s),c){let e="";const t=20;c.addEventListener("input",(n=>{const r=n.target.value;if(r.length>t)return c.value=e,void p();const a=r.length>e.length?r.charAt(r.length-1):null;if(a&&!m(a))return c.value=e,void p();e=r,f(r)})),c.addEventListener("keypress",(e=>{m(String.fromCharCode(e.keyCode||e.which))||(e.preventDefault(),p())})),c.addEventListener("paste",(n=>{n.preventDefault();const r=(n.clipboardData||window.clipboardData).getData("text");let a=e;for(const e of r){if(a.length>=t)break;m(e)&&(a+=e)}c.value=a,e=a,f(a),a.length<e.length+r.length&&p()})),f(c.value),e=c.value}r.style.display="none"})),document.dispatchEvent(new Event("url-builder-ready"))}));