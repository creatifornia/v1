document.addEventListener("data-ready",(function(){document.querySelectorAll("[cf-currency-build]").forEach((e=>{const t=e.querySelector("input[type='text']");if(!t)return;const r=JSON.parse(localStorage.getItem("offices")||"{}"),a=r?.country?.currency||{},i=a?.ISO_4217||"MXN",n=a?.symbol||"$",u=parseFloat(e.getAttribute("cf-min-currency"))||0,s=parseFloat(e.getAttribute("cf-max-currency"))||Number.MAX_SAFE_INTEGER,d=e.getAttribute("cf-currency-path"),o="true"===e.getAttribute("cf-required"),c=a?.required_message,l=a?.minimum_message?`${a.minimum_message} ${n}${(u/100).toFixed(2)}`:`El monto mínimo es ${n}${(u/100).toFixed(2)}`,m=a?.max_message?`${a.max_message} ${n}${(s/100).toFixed(2)}`:`El monto máximo es ${n}${(s/100).toFixed(2)}`,g=document.createElement("input");g.type="hidden",g.name=d,g.setAttribute("cf-json-path",d),g.setAttribute("data-min-amount",u),g.setAttribute("data-max-amount",s),g.setAttribute("data-currency-symbol",n),g.setAttribute("data-currency-code",i),g.setAttribute("data-min-message",l),g.setAttribute("data-max-message",m),o&&c&&(g.setAttribute("data-required",""),g.setAttribute("data-required-message",c)),e.insertBefore(g,t.nextSibling);let y=0,b="";const f=e=>`${n}${e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}`,p=e=>`${n}${e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")} ${i}`,v=e=>{const t=parseFloat(e.replace(/,/g,"."))||0;y=t,g.value=JSON.stringify({unit_amount:Math.round(100*t),display_value:f(t),display_value_full:p(t),currency:i,symbol:n,raw_value:t})};t.addEventListener("input",(e=>{const r=e.target.value;if(!(e=>{if((e.match(/[.,]/g)||[]).length>1)return!1;if(e.includes(".")||e.includes(",")){const t=e.split(/[.,]/);if(t[1]&&t[1].length>2)return!1}return/^[\d.,]*$/.test(e)})(r))return t.classList.add("invalid"),setTimeout((()=>t.classList.remove("invalid")),500),void(e.target.value=b);b=r,v(r)})),t.addEventListener("blur",(()=>{y<u/100?(t.value=f(u/100),v((u/100).toString()),showErrorModal(l)):y>s/100?(t.value=f(s/100),v((s/100).toString()),showErrorModal(m)):t.value=f(y)}))})),document.dispatchEvent(new Event("currency-builder-ready"))}));