document.addEventListener("data-ready",(function(){document.querySelectorAll("[url-friendly]").forEach((e=>{const t=e.getAttribute("url-friendly"),n=e.getAttribute("json-path"),r=document.getElementById(t),i=e.getAttribute("message-path"),a=DynamicText.getWithDefault(i,"Required*"),l=e.getAttribute("preview-username"),u=e.getAttribute("preview-url-friendly");if(!r)return void console.error(`❌ No se encontró template con id="${t}"`);const o=r.cloneNode(!0);o.removeAttribute("id"),e.appendChild(o);const d=o.querySelector("[update-this-with-type-username]"),s=o.querySelector("[update-this-with-type-url]"),c=o.querySelector("[text-input-element]"),p=document.createElement("input");function g(e){return/^[\p{L}\p{N}\s_-]$/u.test(e)}function f(){c.classList.add("invalid"),setTimeout((()=>c.classList.remove("invalid")),500)}function m(e){const t=e.trim(),n=t.replace(/-/g,"_").replace(/\s+/g," "),r=e.trim().toLowerCase().replace(/\s+/g,"-").replace(/_/g,"-").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w-]/g,"");d&&(d.textContent=n||DynamicText.getWithDefault(l,"Username")),s&&(s.textContent=r||DynamicText.getWithDefault(u,"username")),p.value=JSON.stringify({club_name:t,url_friendly:r})}if(p.type="hidden",p.setAttribute("cf-json-path",n),p.setAttribute("data-required-message",a),p.setAttribute("data-required",""),p.value=JSON.stringify({club_name:"",url_friendly:""}),e.insertBefore(p,o),c){let e="";const t=20;c.addEventListener("input",(n=>{const r=n.target.value;if(r.length>t)return c.value=e,void f();const i=r.length>e.length?r.charAt(r.length-1):null;if(i&&!g(i))return c.value=e,void f();e=r,m(r)})),c.addEventListener("keypress",(e=>{g(String.fromCharCode(e.keyCode||e.which))||(e.preventDefault(),f())})),c.addEventListener("paste",(n=>{n.preventDefault();const r=(n.clipboardData||window.clipboardData).getData("text");let i=e;for(const e of r){if(i.length>=t)break;g(e)&&(i+=e)}c.value=i,e=i,m(i),i.length<e.length+r.length&&f()})),m(c.value),e=c.value}r.style.display="none"})),document.dispatchEvent(new Event("url-builder-ready"))}));